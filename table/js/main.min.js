let e=document.getElementById("rows"),t=document.getElementById("cols"),l=document.querySelector(".create-table"),o=document.querySelector(".input-data-wrapper"),r=document.querySelector(".settings"),n=document.querySelector(".table-wrapper"),c=document.querySelector(".table-code");l.addEventListener("click",function(){let l=/^\d+$/;l.test(e.value)&&l.test(t.value)?(document.body.classList.add("changed"),o.classList.add("input-data_hidden"),r.classList.add("settings_visible"),n.classList.add("table-wrapper_visible"),c.classList.add("table-code_visible"),function(){let l=parseInt(e.value),o=parseInt(t.value),r=document.createElement("table");r.classList.add("table"),n.appendChild(r);for(let e=0;e<l;e++){let t=document.createElement("tr");0===e&&t.classList.add("table__head"),t.classList.add("table__row"),r.appendChild(t);for(let e=0;e<o;e++){let e=document.createElement("td");e.classList.add("table__cell"),t.appendChild(e);let l=document.createElement("INPUT");l.type="text",l.classList.add("table__input"),e.appendChild(l)}}}()):alert("Заполните все поля числами!")}),n.addEventListener("input",function(e){let t=document.querySelector(".table"),l=e.target;"INPUT"===l.tagName&&(l.style.width=10*(l.value.length+2)+"px",t.offsetWidth>document.documentElement.clientWidth-25&&l.blur())});let d=document.querySelector(".toggle-button"),a=document.querySelector(".toggle-list");d.addEventListener("click",function(e){a.classList.toggle("toggle-list-active")}),a.addEventListener("click",function(e){let t=document.querySelectorAll(".table__cell"),l=e.target;"LI"===l.tagName&&a.classList.remove("toggle-list-active");for(let e of t)"dashed"===l.dataset.borderStyle?e.style.borderStyle="dashed":"dotted"===l.dataset.borderStyle?e.style.borderStyle="dotted":e.style.borderStyle="solid"});let s=document.getElementById("border-color"),i=document.getElementById("background-color"),u=document.getElementById("text-color");function b(e,t){let l=document.querySelector(".table"),o=document.querySelectorAll(".table__head .table__cell"),r=document.querySelectorAll(".table__input");if("background-color"===e){for(let l of o)l.style.setProperty(e,t);l.style.borderBottom=`3px solid ${i.value}`}else if("color"===e)for(let l of r)l.parentNode.parentNode.classList.contains("table__head")||l.style.setProperty(e,t);else for(let l of r)l.parentNode.style.setProperty(e,t)}s.addEventListener("input",function(){b("border-color",s.value)}),i.addEventListener("input",function(){b("background-color",i.value)}),u.addEventListener("input",function(){b("color",u.value)}),document.querySelector(".constructor__remove-cells").addEventListener("click",function(e){let t=document.querySelector(".table"),l=document.querySelectorAll(".table__row"),o=t.lastChild,r=e.target;if("BUTTON"===r.tagName)if("row"===r.dataset.remove){if(2===t.children.length)return;o.parentNode.removeChild(o)}else for(let e=0;e<l.length;e++)for(let t=l[e].children.length-1;t>0;t--)if(t>0){l[e].children[t].parentNode.removeChild(l[e].children[t]);break}}),document.querySelector(".constructor__insert-cells").addEventListener("click",function(e){let t=document.querySelector(".table"),l=document.querySelectorAll(".table__row"),o=l[l.length-1].cloneNode(!0),r=[...o.children],n=e.target;if("BUTTON"===n.tagName)if("row"===n.dataset.insert)t.appendChild(o),r.forEach(e=>e.children[0].value="");else for(let e of l){let t=document.createElement("td");t.classList.add("table__cell"),e.appendChild(t),t.style.borderStyle=t.previousElementSibling.style.borderStyle,t.style.borderColor=t.previousElementSibling.style.borderColor,t.style.backgroundColor=t.previousElementSibling.style.backgroundColor;let l=document.createElement("INPUT");l.type="text",l.classList.add("table__input"),t.appendChild(l),l.style.color=l.parentNode.previousElementSibling.children[0].style.color}}),document.querySelector(".constructor__sort-table").addEventListener("click",function(e){let t=document.querySelectorAll(".table__row"),l=document.querySelectorAll(".table__head .table__cell").length,o=[],r=e.target;for(let e=0;e<l;e++){for(let l=0;l<t.length;l++)0!==l&&o.push(t[l].children[e].children[0].value);if("BUTTON"===r.tagName){o.some(e=>isNaN(+e))?"plus"===r.dataset.index?o.sort():o.sort().reverse():"plus"===r.dataset.index?o.sort((e,t)=>e-t):o.sort((e,t)=>t-e);for(let l=0;l<t.length;l++)0!==l&&(t[l].children[e].children[0].value=o.splice(0,1))}}}),document.querySelector(".clear").addEventListener("click",function(){let e=document.querySelectorAll(".table__input");for(let t of e)t.value=""}),document.querySelector(".generate-code").addEventListener("click",function(){if(confirm("Внимание! После этого редактирование таблицы будет запрещено. Продолжить?")){let t=document.querySelector(".table"),l=document.querySelectorAll(".table__cell"),o=document.querySelector(".table-code__textarea");for(var e=0;e<l.length;e++)l[e].parentNode.classList.contains("table__head")||(l[e].style.color=l[e].children[0].style.color||"#999999"),l[e].innerHTML=l[e].children[0].value;o.value=`<style type="text/css">\n.table {\n    border-collapse: collapse;\n    border-bottom: 3px solid #00cccd;\n    box-shadow: 0 0 5px #b9b9b9;\n    font-family: Arial, sans-serif;\n}\n\n.table__head .table__cell {\n    background-color: #00cccd;\n    font-weight: bold;\n}\n\n.table__cell {\n    border: 1px solid #d5e8f5;\n    background-color: #fff;\n    width: 55px;\n    height: 55px;\n    color: #fff;\n    text-align: center;\n    font-size: 18px;\n    padding: 10px 8px 8px 8px;\n}\n</style> \n\n${t.outerHTML}`}}),document.querySelector(".copy-code").addEventListener("click",function(){document.querySelector(".table-code__textarea").select(),document.execCommand("copy")});