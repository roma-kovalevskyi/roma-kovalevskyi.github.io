let t=JSON.parse(localStorage.getItem("tasks"));new class{constructor(t,e){this.model=t,this.view=e}createForm(){this.view.renderForm(this.model.getInitialTask())}renderToDoList(){this.view.renderList(this.model.tasks)}addListeners(){this.view.listHTML.addEventListener("click",t=>{let e=t.target;if("BUTTON"===e.nodeName||"INPUT"===e.nodeName){let t=+e.parentNode.getAttribute("data-id");"checkbox"===e.type?this.model.toggleState(t):this.model.removeTask(t),this.view.clear(),this.init()}}),this.view.form.addEventListener("submit",t=>{t.preventDefault();let e=this.view.formInput.value,i=this.view.formInput.getAttribute("data-id");e.length?(this.model.addTask({title:e,done:!1,id:+i}),this.view.clear(),this.init()):alert("Введите название задачи!")})}init(){this.createForm(),this.renderToDoList(),this.addListeners()}}(new class{constructor(t){this.tasks=t}addTask(t){this.tasks.push(t),this.updateTaskInLocalStorage()}updateTaskInLocalStorage(){localStorage.removeItem("tasks"),localStorage.setItem("tasks",JSON.stringify(this.tasks))}removeTask(t){this.tasks=this.tasks.filter(e=>e.id!==t),this.updateTaskInLocalStorage()}toggleState(t){let e=this.tasks.find(e=>e.id===t);e.done=!e.done,this.updateTaskInLocalStorage()}getInitialTask(){return{title:"",done:!1,id:Date.now()}}}(Array.isArray(t)?t:[]),new class{constructor(t){this.root=t}clear(){this.root.innerHTML=""}renderForm(t){let e=document.createElement("form"),i=document.createElement("input"),s=document.createElement("button");i.value=t.title,i.setAttribute("data-id",t.id),i.type="text",i.placeholder="Название задачи...",s.innerText="+",s.type="submit",e.classList.add("form"),i.classList.add("form__input"),s.classList.add("form__button"),e.appendChild(i),e.appendChild(s),this.form=e,this.formInput=i,this.root.appendChild(e)}renderList(t){this.listHTML=document.createElement("ul"),t.map(this.renderItem).forEach(t=>this.listHTML.appendChild(t),this),this.listHTML.classList.add("list"),this.root.appendChild(this.listHTML)}renderItem(t){let e=document.createElement("li"),i=document.createElement("input"),s=document.createElement("label"),a=document.createElement("span"),d=document.createElement("button");return e.classList.add("list__item"),i.classList.add("list__item-checkbox"),i.id=`input${t.id}`,s.classList.add("list__item-label"),s.htmlFor=i.id,a.classList.add("list__item-span"),d.classList.add("list__item-btn"),i.type="checkbox",a.innerText=t.title,t.done&&(i.setAttribute("checked",!0),a.style.textDecoration="line-through"),e.setAttribute("data-id",t.id),e.appendChild(i),e.appendChild(s),e.appendChild(a),e.appendChild(d),e}}(document.getElementById("root"))).init();